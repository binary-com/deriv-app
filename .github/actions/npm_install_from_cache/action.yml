name: npm_install
description: Install npm packages
runs:
  using: composite
  steps:
  - name: Cache node modules
    id: cache-npm
    uses: actions/cache@v3
    env:
      cache-name: cache-node-modules
    with:
      # npm cache files are stored in `node_modules` on Linux/macOS
      path: |
        node_modules
        packages/*/node_modules
      key: ${{ runner.os }}-build-${{ env.cache-name }}-${{ hashFiles('package-lock.json') }}-${{ hashFiles('packages/*/package.json') }}
      restore-keys: |
        ${{ runner.os }}-build-${{ env.cache-name }}-
        ${{ runner.os }}-build-
        ${{ runner.os }}-
  - if: ${{ steps.cache-npm.outputs.cache-hit != 'true' }}
    name: Install dependencies
    run: |
      npm ci
      npm run bootstrap:ci
    shell: bash
